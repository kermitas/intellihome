<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>20.2. Core API</title><link rel="stylesheet" href="docbook-xsl.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.75.2" /><link rel="home" href="index.html" title="The Neo4j Manual v1.8.M04" /><link rel="up" href="python-embedded.html" title="Chapter 20. Python embedded bindings" /><link rel="prev" href="python-embedded-installation.html" title="20.1. Installation" /><link rel="next" href="python-embedded-reference-indexes.html" title="20.3. Indexes" /><link rel="preface" href="preface.html" title="Preface" /><link rel="part" href="introduction.html" title="Part I. Introduction" /><link rel="chapter" href="introduction-highlights.html" title="Chapter 1. Neo4j Highlights" /><link rel="chapter" href="graphdb-concepts.html" title="Chapter 2. Graph Database Concepts" /><link rel="chapter" href="graphdb-neo4j.html" title="Chapter 3. The Neo4j Graph Database" /><link rel="part" href="tutorials.html" title="Part II. Tutorials" /><link rel="chapter" href="tutorials-java-embedded.html" title="Chapter 4. Using Neo4j embedded in Java applications" /><link rel="chapter" href="cypher-cookbook.html" title="Chapter 5. Cypher Cookbook" /><link rel="chapter" href="tutorials-rest.html" title="Chapter 6. Neo4j Remote Client Libraries" /><link rel="chapter" href="server-extending.html" title="Chapter 7. Extending the Neo4j Server" /><link rel="chapter" href="tutorial-traversal.html" title="Chapter 8. The Traversal Framework" /><link rel="chapter" href="domain-modeling-gallery.html" title="Chapter 9. Domain Modeling Gallery" /><link rel="chapter" href="languages.html" title="Chapter 10. Languages" /><link rel="chapter" href="tutorials-python-embedded.html" title="Chapter 11. Using Neo4j embedded in Python applications" /><link rel="part" href="reference-documentation.html" title="Part III. Reference" /><link rel="chapter" href="capabilities.html" title="Chapter 12. Capabilities" /><link rel="chapter" href="transactions.html" title="Chapter 13. Transaction Management" /><link rel="chapter" href="import.html" title="Chapter 14. Data Import" /><link rel="chapter" href="indexing.html" title="Chapter 15. Indexing" /><link rel="chapter" href="cypher-query-lang.html" title="Chapter 16. Cypher Query Language" /><link rel="chapter" href="graph-algo.html" title="Chapter 17. Graph Algorithms" /><link rel="chapter" href="server.html" title="Chapter 18. Neo4j Server" /><link rel="chapter" href="rest-api.html" title="Chapter 19. REST API" /><link rel="chapter" href="python-embedded.html" title="Chapter 20. Python embedded bindings" /><link rel="part" href="operations.html" title="Part IV. Operations" /><link rel="chapter" href="deployment.html" title="Chapter 21. Installation &amp; Deployment" /><link rel="chapter" href="embedded-configuration.html" title="Chapter 22. Configuration &amp; Performance" /><link rel="chapter" href="ha.html" title="Chapter 23. High Availability" /><link rel="chapter" href="operations-backup.html" title="Chapter 24. Backup" /><link rel="chapter" href="operations-security.html" title="Chapter 25. Security" /><link rel="chapter" href="operations-monitoring.html" title="Chapter 26. Monitoring" /><link rel="part" href="tools.html" title="Part V. Tools" /><link rel="chapter" href="tools-webadmin.html" title="Chapter 27. Web Administration" /><link rel="chapter" href="shell.html" title="Chapter 28. Neo4j Shell" /><link rel="part" href="community.html" title="Part VI. Community" /><link rel="chapter" href="community-support.html" title="Chapter 29. Community Support" /><link rel="chapter" href="community-contributing.html" title="Chapter 30. Contributing to Neo4j" /><link rel="appendix" href="manpages.html" title="Appendix A. Manpages" /><link rel="refentry" href="re01.html" title="neo4j" /><link rel="refentry" href="re02.html" title="neo4j-shell" /><link rel="refentry" href="re03.html" title="neo4j-backup" /><link rel="refentry" href="re04.html" title="neo4j-coordinator" /><link rel="refentry" href="re05.html" title="neo4j-coordinator-shell" /><link rel="appendix" href="questions.html" title="Appendix B. Questions &amp; Answers" /><link rel="subsection" href="python-embedded-reference-core.html#_getting_started" title="20.2.1. Getting started" /><link rel="subsection" href="python-embedded-reference-core.html#_transactions" title="20.2.2. Transactions" /><link rel="subsection" href="python-embedded-reference-core.html#python-embedded-core-nodes" title="20.2.3. Nodes" /><link rel="subsection" href="python-embedded-reference-core.html#python-embedded-core-relationships" title="20.2.4. Relationships" /><link rel="subsection" href="python-embedded-reference-core.html#python-embedded-core-properties" title="20.2.5. Properties" /><link rel="subsection" href="python-embedded-reference-core.html#python-embedded-core-paths" title="20.2.6. Paths" /><link rel="copyright" href="ln-id464096.html" title="License: Creative Commons 3.0" />


<!-- favicon -->

<link rel="shortcut icon" href="http://neo4j.org/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="icon" href="http://neo4j.org/favicon.ico" type="image/x-icon" />

<!-- style -->

<link href="css/shCore.css" rel="stylesheet" type="text/css" />
<link href="css/shCoreEclipse.css" rel="stylesheet" type="text/css" />
<link href="css/shThemeEclipse.css" rel="stylesheet" type="text/css" />
<link href="css/neo.css" rel="stylesheet" type="text/css" />

<!-- Syntax Highlighter -->

<script type="text/javascript" src="js/shCore.js"></script>
<script type="text/javascript" src="js/shBrushJava.js"></script>
<script type="text/javascript" src="js/shBrushJScript.js"></script>
<script type="text/javascript" src="js/shBrushBash.js"></script>
<script type="text/javascript" src="js/shBrushPlain.js"></script>
<script type="text/javascript" src="js/shBrushXml.js"></script>
<script type="text/javascript" src="js/shBrushGroovy.js"></script>
<script type="text/javascript" src="js/shBrushCypher.js"></script>
<script type="text/javascript" src="js/shBrushScala.js"></script>
<script type="text/javascript" src="js/shBrushSql.js"></script>
<script type="text/javascript" src="js/shBrushPython.js"></script>

<!-- activate when needed
<script type="text/javascript" src="js/shBrushRuby.js"></script>
<script type="text/javascript" src="js/shBrushCSharp.js"></script>
-->
 
<script type="text/javascript">
  SyntaxHighlighter.defaults['tab-size'] = 4;
  SyntaxHighlighter.defaults['gutter'] = false;
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all()
</script>

<!-- JQuery -->

<script type="text/javascript" src="js/jquery-1.6.4.min.js"></script>

<!-- Replace SVG for browsers that lack support. -->
<script type="text/javascript" src="js/svgreplacer.js"></script>

<!-- Image Scaler -->

<script type="text/javascript" src="js/imagescaler.js"></script>

<!-- Table Styler -->

<script type="text/javascript" src="js/tablestyler.js"></script>

<!-- Version -->

<script type="text/javascript" src="js/version.js"></script>

<!-- Offline Sidebar -->

<script type="text/javascript" src="js/sidebar.js"></script>


<div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">The Neo4j Manual</a></span> &gt; <span class="breadcrumb-link"><a href="reference-documentation.html">Reference</a></span> &gt; <span class="breadcrumb-link"><a href="python-embedded.html">Python embedded bindings</a></span> &gt; <span class="breadcrumb-node">Core API</span></div></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="python-embedded-installation.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="python-embedded-reference-indexes.html">Next</a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="python-embedded-reference-core"></a>20.2. Core API</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="python-embedded-reference-core.html#_getting_started">20.2.1. Getting started</a></span></dt><dt><span class="section"><a href="python-embedded-reference-core.html#_transactions">20.2.2. Transactions</a></span></dt><dt><span class="section"><a href="python-embedded-reference-core.html#python-embedded-core-nodes">20.2.3. Nodes</a></span></dt><dt><span class="section"><a href="python-embedded-reference-core.html#python-embedded-core-relationships">20.2.4. Relationships</a></span></dt><dt><span class="section"><a href="python-embedded-reference-core.html#python-embedded-core-properties">20.2.5. Properties</a></span></dt><dt><span class="section"><a href="python-embedded-reference-core.html#python-embedded-core-paths">20.2.6. Paths</a></span></dt></dl></div><p>This section describes how get get up and running, and how to do basic operations.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_getting_started"></a>20.2.1. Getting started</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_creating_a_database"></a>Creating a database</h4></div></div></div><pre class="programlisting brush: python">from neo4j import GraphDatabase

# Create db
db = GraphDatabase(folder_to_put_db_in)

# Always shut down your database
db.shutdown()
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_creating_a_database_with_configuration"></a>Creating a database, with configuration</h4></div></div></div><p>Please see <a class="xref" href="embedded-configuration.html" title="Chapter 22. Configuration &amp; Performance">Chapter 22, <i>Configuration &amp; Performance</i></a> for what options you can use here.</p><pre class="programlisting brush: python">from neo4j import GraphDatabase

# Example configuration parameters
db = GraphDatabase(folder_to_put_db_in, string_block_size=200, array_block_size=240)

db.shutdown()
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_jpype_jvm_configuration"></a>JPype JVM configuration</h4></div></div></div><p>You can set extra arguments to be passed to the JVM using the <code class="literal">NEO4J_PYTHON_JVMARGS</code> environment variable.
This can be used to, for instance, increase the max memory for the database.</p><p>Note that you must set this before you import the neo4j package, either by setting it before you start python, or by setting it programatically in your app.</p><pre class="programlisting brush: python">import os
os.environ['NEO4J_PYTHON_JVMARGS'] = '-Xms128M -Xmx512M'
import neo4j</pre><p>You can also override the classpath used by neo4j-embedded, by setting the <code class="literal">NEO4J_PYTHON_CLASSPATH</code> environment variable.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_transactions"></a>20.2.2. Transactions</h3></div></div></div><p>All write operations to the database need to be performed from within transactions.
This ensures that your database never ends up in an inconsistent state.</p><p>See <a class="xref" href="transactions.html" title="Chapter 13. Transaction Management">Chapter 13, <i>Transaction Management</i></a> for details on how Neo4j handles transactions.</p><p>We use the python <code class="literal">with</code> statement to define a transaction context.
If you are using an older version of Python, you may have to import the <code class="literal">with</code> statement:</p><pre class="programlisting brush: python">from __future__ import with_statement</pre><p>Either way, this is how you get into a transaction:</p><pre class="programlisting brush: python"># Start a transaction
with db.transaction:
    # This is inside the transactional
    # context. All work done here
    # will either entirely succeed,
    # or no changes will be applied at all.

    # Create a node
    node = db.node()

    # Give it a name
    node['name'] = 'Cat Stevens'

# The transaction is automatically
# commited when you exit the with
# block.
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="python-embedded-core-nodes"></a>20.2.3. Nodes</h3></div></div></div><p>This describes operations that are specific to node objects.
For documentation on how to handle properties on both relationships and nodes, see <a class="xref" href="python-embedded-reference-core.html#python-embedded-core-properties" title="20.2.5. Properties">Section 20.2.5, “Properties”</a>.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_creating_a_node_2"></a>Creating a node</h4></div></div></div><pre class="programlisting brush: python">with db.transaction:
    # Create a node
    thomas = db.node(name='Thomas Anderson', age=42)
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_fetching_a_node_by_id"></a>Fetching a node by id</h4></div></div></div><pre class="programlisting brush: python"># You don't have to be in a transaction
# to do read operations.
a_node = db.node[some_node_id]

# Ids on nodes and relationships are available via the "id"
# property, eg.:
node_id = a_node.id
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_fetching_the_reference_node"></a>Fetching the reference node</h4></div></div></div><pre class="programlisting brush: python">reference = db.reference_node
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_removing_a_node"></a>Removing a node</h4></div></div></div><pre class="programlisting brush: python">with db.transaction:
    node = db.node()
    node.delete()
</pre><div class="tip" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/icons/admon/tip.png" /></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>See also <a class="xref" href="transactions-delete.html" title="13.5. Delete semantics">Section 13.5, “Delete semantics”</a>.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_removing_a_node_by_id"></a>Removing a node by id</h4></div></div></div><pre class="programlisting brush: python">with db.transaction:
    del db.node[some_node_id]
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_accessing_relationships_from_a_node"></a>Accessing relationships from a node</h4></div></div></div><p>For details on what you can do with the relationship objects, see <a class="xref" href="python-embedded-reference-core.html#python-embedded-core-relationships" title="20.2.4. Relationships">Section 20.2.4, “Relationships”</a>.</p><pre class="programlisting brush: python"># All relationships on a node
for rel in a_node.relationships:
    pass

# Incoming relationships
for rel in a_node.relationships.incoming:
    pass

# Outgoing relationships
for rel in a_node.relationships.outgoing:
    pass

# Relationships of a specific type
for rel in a_node.mayor_of:
    pass

# Incoming relationships of a specific type
for rel in a_node.mayor_of.incoming:
    pass

# Outgoing relationships of a specific type
for rel in a_node.mayor_of.outgoing:
    pass
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_getting_and_or_counting_all_nodes"></a>Getting and/or counting all nodes</h4></div></div></div><p>Use this with care, it will become extremely slow in large datasets.</p><pre class="programlisting brush: python">for node in db.nodes:
    pass

# Shorthand for iterating through
# and counting all nodes
number_of_nodes = len(db.nodes)
</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="python-embedded-core-relationships"></a>20.2.4. Relationships</h3></div></div></div><p>This describes operations that are specific to relationship objects.
For documentation on how to handle properties on both relationships and nodes, see <a class="xref" href="python-embedded-reference-core.html#python-embedded-core-properties" title="20.2.5. Properties">Section 20.2.5, “Properties”</a>.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_creating_a_relationship"></a>Creating a relationship</h4></div></div></div><pre class="programlisting brush: python">with db.transaction:
    # Nodes to create a relationship between
    steven = self.graphdb.node(name='Steve Brook')
    poplar_bluff = self.graphdb.node(name='Poplar Bluff')

    # Create a relationship of type "mayor_of"
    relationship = steven.mayor_of(poplar_bluff, since="12th of July 2012")

    # Or, to create relationship types with names
    # that would not be possible with the above
    # method.
    steven.relationships.create('mayor_of', poplar_bluff, since="12th of July 2012")
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_fetching_a_relationship_by_id"></a>Fetching a relationship by id</h4></div></div></div><pre class="programlisting brush: python">the_relationship = db.relationship[a_relationship_id]
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_removing_a_relationship"></a>Removing a relationship</h4></div></div></div><pre class="programlisting brush: python">with db.transaction:
    # Create a relationship
    source = db.node()
    target = db.node()
    rel = source.Knows(target)

    # Delete it
    rel.delete()
</pre><div class="tip" style="margin-left: 0; margin-right: 10%;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/icons/admon/tip.png" /></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>See also <a class="xref" href="transactions-delete.html" title="13.5. Delete semantics">Section 13.5, “Delete semantics”</a>.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_removing_a_relationship_by_id"></a>Removing a relationship by id</h4></div></div></div><pre class="programlisting brush: python">with db.transaction:
    del db.relationship[some_relationship_id]
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_relationship_start_node_end_node_and_type"></a>Relationship start node, end node and type</h4></div></div></div><pre class="programlisting brush: python">relationship_type = relationship.type

start_node = relationship.start
end_node = relationship.end
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_getting_and_or_counting_all_relationships"></a>Getting and/or counting all relationships</h4></div></div></div><p>Use this with care, it will become extremely slow in large datasets.</p><pre class="programlisting brush: python">for rel in db.relationships:
    pass

# Shorthand for iterating through
# and counting all relationships
number_of_rels = len(db.relationships)
</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="python-embedded-core-properties"></a>20.2.5. Properties</h3></div></div></div><p>Both nodes and relationships can have properties, so this section applies equally to both node and relationship objects.
Allowed property values include strings, numbers, booleans, as well as arrays of those primitives.
Within each array, all values must be of the same type.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_setting_properties"></a>Setting properties</h4></div></div></div><pre class="programlisting brush: python">with db.transaction:
    node_or_rel['name'] = 'Thomas Anderson'
    node_or_rel['age'] = 42
    node_or_rel['favourite_numbers'] = [1,2,3]
    node_or_rel['favourite_words'] = ['banana','blue']
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_getting_properties"></a>Getting properties</h4></div></div></div><pre class="programlisting brush: python">numbers = node_or_rel['favourite_numbers']
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_removing_properties"></a>Removing properties</h4></div></div></div><pre class="programlisting brush: python">with db.transaction:
    del node_or_rel['favourite_numbers']
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_looping_through_properties"></a>Looping through properties</h4></div></div></div><pre class="programlisting brush: python"># Loop key and value at the same time
for key, value in node_or_rel.items():
    pass

# Loop property keys
for key in node_or_rel.keys():
    pass

# Loop property values
for value in node_or_rel.values():
    pass
</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="python-embedded-core-paths"></a>20.2.6. Paths</h3></div></div></div><p>A path object represents a path between two nodes in the graph.
Paths thus contain at least two nodes and one relationship, but can reach arbitrary length.
It is used in various parts of the API, most notably in <a class="link" href="python-embedded-reference-traversal.html" title="20.5. Traversals">traversals</a>.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_accessing_the_start_and_end_nodes"></a>Accessing the start and end nodes</h4></div></div></div><pre class="programlisting brush: python">start_node = path.start
end_node = path.end
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_accessing_the_last_relationship"></a>Accessing the last relationship</h4></div></div></div><pre class="programlisting brush: python">last_relationship = path.last_relationship
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="_looping_through_the_entire_path"></a>Looping through the entire path</h4></div></div></div><p>You can loop through all elements of a path directly, or you can choose to only loop through nodes or relationships.
When you loop through all elements, the first item will be the start node, the second will be the first relationship, the third the node that the relationship led to and so on.</p><pre class="programlisting brush: python">for item in path:
    # Item is either a Relationship,
    # or a Node
    pass

for nodes in path.nodes:
    # All nodes in a path
    pass

for nodes in path.relationships:
    # All relationships in a path
    pass
</pre></div></div></div><HR xmlns=""></HR><a xmlns="" href="ln-id464096.html"><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">Copyright © 2012 Neo Technology</p></a><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="python-embedded-installation.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="python-embedded.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="python-embedded-reference-indexes.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>
