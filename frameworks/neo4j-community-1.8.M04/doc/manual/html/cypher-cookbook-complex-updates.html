<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>5.9. Complex updates</title><link rel="stylesheet" href="docbook-xsl.css" type="text/css" /><meta name="generator" content="DocBook XSL Stylesheets V1.75.2" /><link rel="home" href="index.html" title="The Neo4j Manual v1.8.M04" /><link rel="up" href="cypher-cookbook.html" title="Chapter 5. Cypher Cookbook" /><link rel="prev" href="cypher-cookbook-pretty-graphs.html" title="5.8. Pretty graphs in Cypher" /><link rel="next" href="cypher-cookbook-path-tree.html" title="5.10. A multilevel indexing structure (path tree)" /><link rel="preface" href="preface.html" title="Preface" /><link rel="part" href="introduction.html" title="Part I. Introduction" /><link rel="chapter" href="introduction-highlights.html" title="Chapter 1. Neo4j Highlights" /><link rel="chapter" href="graphdb-concepts.html" title="Chapter 2. Graph Database Concepts" /><link rel="chapter" href="graphdb-neo4j.html" title="Chapter 3. The Neo4j Graph Database" /><link rel="part" href="tutorials.html" title="Part II. Tutorials" /><link rel="chapter" href="tutorials-java-embedded.html" title="Chapter 4. Using Neo4j embedded in Java applications" /><link rel="chapter" href="cypher-cookbook.html" title="Chapter 5. Cypher Cookbook" /><link rel="chapter" href="tutorials-rest.html" title="Chapter 6. Neo4j Remote Client Libraries" /><link rel="chapter" href="server-extending.html" title="Chapter 7. Extending the Neo4j Server" /><link rel="chapter" href="tutorial-traversal.html" title="Chapter 8. The Traversal Framework" /><link rel="chapter" href="domain-modeling-gallery.html" title="Chapter 9. Domain Modeling Gallery" /><link rel="chapter" href="languages.html" title="Chapter 10. Languages" /><link rel="chapter" href="tutorials-python-embedded.html" title="Chapter 11. Using Neo4j embedded in Python applications" /><link rel="part" href="reference-documentation.html" title="Part III. Reference" /><link rel="chapter" href="capabilities.html" title="Chapter 12. Capabilities" /><link rel="chapter" href="transactions.html" title="Chapter 13. Transaction Management" /><link rel="chapter" href="import.html" title="Chapter 14. Data Import" /><link rel="chapter" href="indexing.html" title="Chapter 15. Indexing" /><link rel="chapter" href="cypher-query-lang.html" title="Chapter 16. Cypher Query Language" /><link rel="chapter" href="graph-algo.html" title="Chapter 17. Graph Algorithms" /><link rel="chapter" href="server.html" title="Chapter 18. Neo4j Server" /><link rel="chapter" href="rest-api.html" title="Chapter 19. REST API" /><link rel="chapter" href="python-embedded.html" title="Chapter 20. Python embedded bindings" /><link rel="part" href="operations.html" title="Part IV. Operations" /><link rel="chapter" href="deployment.html" title="Chapter 21. Installation &amp; Deployment" /><link rel="chapter" href="embedded-configuration.html" title="Chapter 22. Configuration &amp; Performance" /><link rel="chapter" href="ha.html" title="Chapter 23. High Availability" /><link rel="chapter" href="operations-backup.html" title="Chapter 24. Backup" /><link rel="chapter" href="operations-security.html" title="Chapter 25. Security" /><link rel="chapter" href="operations-monitoring.html" title="Chapter 26. Monitoring" /><link rel="part" href="tools.html" title="Part V. Tools" /><link rel="chapter" href="tools-webadmin.html" title="Chapter 27. Web Administration" /><link rel="chapter" href="shell.html" title="Chapter 28. Neo4j Shell" /><link rel="part" href="community.html" title="Part VI. Community" /><link rel="chapter" href="community-support.html" title="Chapter 29. Community Support" /><link rel="chapter" href="community-contributing.html" title="Chapter 30. Contributing to Neo4j" /><link rel="appendix" href="manpages.html" title="Appendix A. Manpages" /><link rel="refentry" href="re01.html" title="neo4j" /><link rel="refentry" href="re02.html" title="neo4j-shell" /><link rel="refentry" href="re03.html" title="neo4j-backup" /><link rel="refentry" href="re04.html" title="neo4j-coordinator" /><link rel="refentry" href="re05.html" title="neo4j-coordinator-shell" /><link rel="appendix" href="questions.html" title="Appendix B. Questions &amp; Answers" /><link rel="subsection" href="cypher-cookbook-complex-updates.html#cookbook-insert-a-new-value-into-a-linked-list" title="5.9.1. Insert a new value into a linked list" /><link rel="copyright" href="ln-id464096.html" title="License: Creative Commons 3.0" />


<!-- favicon -->

<link rel="shortcut icon" href="http://neo4j.org/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="icon" href="http://neo4j.org/favicon.ico" type="image/x-icon" />

<!-- style -->

<link href="css/shCore.css" rel="stylesheet" type="text/css" />
<link href="css/shCoreEclipse.css" rel="stylesheet" type="text/css" />
<link href="css/shThemeEclipse.css" rel="stylesheet" type="text/css" />
<link href="css/neo.css" rel="stylesheet" type="text/css" />

<!-- Syntax Highlighter -->

<script type="text/javascript" src="js/shCore.js"></script>
<script type="text/javascript" src="js/shBrushJava.js"></script>
<script type="text/javascript" src="js/shBrushJScript.js"></script>
<script type="text/javascript" src="js/shBrushBash.js"></script>
<script type="text/javascript" src="js/shBrushPlain.js"></script>
<script type="text/javascript" src="js/shBrushXml.js"></script>
<script type="text/javascript" src="js/shBrushGroovy.js"></script>
<script type="text/javascript" src="js/shBrushCypher.js"></script>
<script type="text/javascript" src="js/shBrushScala.js"></script>
<script type="text/javascript" src="js/shBrushSql.js"></script>
<script type="text/javascript" src="js/shBrushPython.js"></script>

<!-- activate when needed
<script type="text/javascript" src="js/shBrushRuby.js"></script>
<script type="text/javascript" src="js/shBrushCSharp.js"></script>
-->
 
<script type="text/javascript">
  SyntaxHighlighter.defaults['tab-size'] = 4;
  SyntaxHighlighter.defaults['gutter'] = false;
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all()
</script>

<!-- JQuery -->

<script type="text/javascript" src="js/jquery-1.6.4.min.js"></script>

<!-- Replace SVG for browsers that lack support. -->
<script type="text/javascript" src="js/svgreplacer.js"></script>

<!-- Image Scaler -->

<script type="text/javascript" src="js/imagescaler.js"></script>

<!-- Table Styler -->

<script type="text/javascript" src="js/tablestyler.js"></script>

<!-- Version -->

<script type="text/javascript" src="js/version.js"></script>

<!-- Offline Sidebar -->

<script type="text/javascript" src="js/sidebar.js"></script>


<div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">The Neo4j Manual</a></span> &gt; <span class="breadcrumb-link"><a href="tutorials.html">Tutorials</a></span> &gt; <span class="breadcrumb-link"><a href="cypher-cookbook.html">Cypher Cookbook</a></span> &gt; <span class="breadcrumb-node">Complex updates</span></div></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="cypher-cookbook-pretty-graphs.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="cypher-cookbook-path-tree.html">Next</a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="cypher-cookbook-complex-updates"></a>5.9. Complex updates</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="cypher-cookbook-complex-updates.html#cookbook-insert-a-new-value-into-a-linked-list">5.9.1. Insert a new value into a linked list</a></span></dt></dl></div><p>This section is showing some graph-related update operations that require advanced graph manipulations.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="cookbook-insert-a-new-value-into-a-linked-list"></a>5.9.1. Insert a new value into a linked list</h3></div></div></div><p>In this example, a new value is inserted at the right position into an existing Linked List.</p><p>Firstly, a new linked list, containing the nodes with values <code class="literal">0</code> and <code class="literal">2</code> is created in the first
subquery.</p><p>In the second part, we are looking for the node in the position before our new node will have, and the node that will come after.
They will already be connected with each other with the relationship identifier <code class="literal">old</code>.
The 0 in <code class="literal">zero-[:LINK*0..]-&gt;before</code> means that there are zero or more relationships between
the root node and the before node. Having zero relationships between two node in a path means that they are the same
node. When the linked list is empty, the <code class="literal">root</code>, <code class="literal">before</code> and <code class="literal">after</code> identifier will all point to the same node -
 the newly created root node. The self relationship will be in the <code class="literal">old</code> identifier.</p><p>In the last query part, the <code class="literal">old</code> relationship is deleted.</p><p><span class="emphasis"><em>Query</em></span></p><pre class="programlisting brush: cypher">CREATE zero={name:0,value:0}, two={value:2,name:2}, zero-[:LINK]-&gt;two-[:LINK]-&gt;zero
==== zero ====
MATCH zero-[:LINK*0..]-&gt;before,
after-[:LINK*0..]-&gt;zero,
before-[old:LINK]-&gt;after
WHERE before.value? &lt;= 1 AND
1 &lt;= after.value?
CREATE newValue={name:1,value : 1},
before-[:LINK]-&gt;newValue,
newValue-[:LINK]-&gt;after
DELETE old
==== zero ====
MATCH p = zero-[:LINK*1..]-&gt;zero
RETURN length(p) as list_length</pre><p>The length of the full list.</p><div class="queryresult table"><a id="id517522"></a><p class="title"><b>Result</b></p><div class="queryresult table-contents"><table summary="Result" cellspacing="0" cellpadding="0" border="1"><colgroup><col /></colgroup><thead><tr><th align="left" valign="top">list_length</th></tr></thead><tfoot><tr><th align="left" valign="top">1 row
</th></tr><tr><th align="left" valign="top">Nodes created: 3
</th></tr><tr><th align="left" valign="top">Relationships created: 4
</th></tr><tr><th align="left" valign="top">Properties set: 6
</th></tr><tr><th align="left" valign="top">Relationships deleted: 1
</th></tr><tr><th align="left" valign="top">9 ms</th></tr></tfoot><tbody><tr><td align="left" valign="top"><p><code class="literal">3</code></p></td></tr></tbody></table></div></div><br class="queryresult table-break" /><p><span class="emphasis"><em>Graph</em></span></p><div class="informalfigure"><a class="ulink" href="images/cypher-linkedlist-graph.svg" target="_top">
<span class="inlinemediaobject"><img src="images/cypher-linkedlist-graph.svg" alt="cypher-linkedlist-graph.svg" /></span>
</a></div></div></div><HR xmlns=""></HR><a xmlns="" href="ln-id464096.html"><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">Copyright © 2012 Neo Technology</p></a><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="cypher-cookbook-pretty-graphs.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="cypher-cookbook.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="cypher-cookbook-path-tree.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>
